<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MarketplaceProject: zod-validation-error</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MarketplaceProject
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md__market_place_frontend_2marketplacefrontend_2node__modules_2zod-validation-error_2_r_e_a_d_m_e_8v3.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">zod-validation-error </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md2523"></a></p>
<p>Wrap zod validation errors in user-friendly readable messages.</p>
<p><a href="https://github.com/causaly/zod-validation-error/actions/workflows/ci.yml"><img src="https://github.com/causaly/zod-validation-error/actions/workflows/ci.yml/badge.svg" alt="Build Status" style="pointer-events: none;" class="inline"/></a> <a href="https://www.npmjs.com/package/zod-validation-error"><img src="https://img.shields.io/npm/v/zod-validation-error.svg?color=0c0" alt="npm version" style="pointer-events: none;" class="inline"/></a></p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2524"></a>
Features</h3>
<ul>
<li>User-friendly readable messages, configurable via options;</li>
<li>Maintain original issues under <span class="tt">error.details</span>;</li>
<li>Supports both <span class="tt">zod</span> v3 and v4.</li>
</ul>
<p><b><em>Note:</em></b> This is the v3 version of <span class="tt">zod-validation-error</span>. If you are looking for zod v4 support, please click here.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md2525"></a>
Installation</h1>
<div class="fragment"><div class="line">npm install zod-validation-error</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md2526"></a>
Requirements</h3>
<ul>
<li>Node.js v.18+</li>
<li>TypeScript v.4.5+</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md2527"></a>
Quick start</h1>
<div class="fragment"><div class="line">import { z as zod } from &#39;zod/v3&#39;;</div>
<div class="line">import { fromError } from &#39;zod-validation-error/v3&#39;;</div>
<div class="line"> </div>
<div class="line">// create zod schema</div>
<div class="line">const zodSchema = zod.object({</div>
<div class="line">  id: zod.number().int().positive(),</div>
<div class="line">  email: zod.string().email(),</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// parse some invalid value</div>
<div class="line">try {</div>
<div class="line">  zodSchema.parse({</div>
<div class="line">    id: 1,</div>
<div class="line">    email: &#39;foobar&#39;, // note: invalid email</div>
<div class="line">  });</div>
<div class="line">} catch (err) {</div>
<div class="line">  const validationError = fromError(err);</div>
<div class="line">  // the error is now readable by the user</div>
<div class="line">  // you may print it to console</div>
<div class="line">  console.log(validationError.toString());</div>
<div class="line">  // or return it as an actual error</div>
<div class="line">  return validationError;</div>
<div class="line">}</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md2528"></a>
Motivation</h1>
<p>Zod errors are difficult to consume for the end-user. This library wraps Zod validation errors in user-friendly readable messages that can be exposed to the outer world, while maintaining the original errors in an array for <em>dev</em> use.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md2529"></a>
Example</h2>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2530"></a>
Input (from Zod)</h3>
<div class="fragment"><div class="line">[</div>
<div class="line">  {</div>
<div class="line">    &quot;code&quot;: &quot;too_small&quot;,</div>
<div class="line">    &quot;inclusive&quot;: false,</div>
<div class="line">    &quot;message&quot;: &quot;Number must be greater than 0&quot;,</div>
<div class="line">    &quot;minimum&quot;: 0,</div>
<div class="line">    &quot;path&quot;: [&quot;id&quot;],</div>
<div class="line">    &quot;type&quot;: &quot;number&quot;</div>
<div class="line">  },</div>
<div class="line">  {</div>
<div class="line">    &quot;code&quot;: &quot;invalid_string&quot;,</div>
<div class="line">    &quot;message&quot;: &quot;Invalid email&quot;,</div>
<div class="line">    &quot;path&quot;: [&quot;email&quot;],</div>
<div class="line">    &quot;validation&quot;: &quot;email&quot;</div>
<div class="line">  }</div>
<div class="line">]</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md2531"></a>
Output</h3>
<div class="fragment"><div class="line">Validation error: Number must be greater than 0 at &quot;id&quot;; Invalid email at &quot;email&quot;</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md2532"></a>
API</h1>
<ul>
<li>ValidationError(message[, options])</li>
<li>createMessageBuilder(props)</li>
<li>errorMap</li>
<li>isValidationError(error)</li>
<li>isValidationErrorLike(error)</li>
<li>isZodErrorLike(error)</li>
<li>fromError(error[, options])</li>
<li>fromZodIssue(zodIssue[, options])</li>
<li>fromZodError(zodError[, options])</li>
<li>toValidationError([options]) =&gt; (error) =&gt; ValidationError</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md2533"></a>
ValidationError</h2>
<p>Main <span class="tt">ValidationError</span> class, extending native JavaScript <span class="tt">Error</span>.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2534"></a>
Arguments</h3>
<ul>
<li><span class="tt">message</span> - <em>string</em>; error message (required)</li>
<li><span class="tt">options</span> - <em>ErrorOptions</em>; error options as per <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error/Error#options">JavaScript definition</a> (optional)<ul>
<li><span class="tt">options.cause</span> - <em>any</em>; can be used to hold the original zod error (optional)</li>
</ul>
</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2535"></a>
Example 1: construct new ValidationError with <span class="tt">message</span></h3>
<div class="fragment"><div class="line">const { ValidationError } = require(&#39;zod-validation-error&#39;);</div>
<div class="line"> </div>
<div class="line">const error = new ValidationError(&#39;foobar&#39;);</div>
<div class="line">console.log(error instanceof Error); // prints true</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md2536"></a>
Example 2: construct new ValidationError with <span class="tt">message</span> and <span class="tt">options.cause</span></h3>
<div class="fragment"><div class="line">import { z as zod } from &#39;zod/v3&#39;;</div>
<div class="line">const { ValidationError } = require(&#39;zod-validation-error&#39;);</div>
<div class="line"> </div>
<div class="line">const error = new ValidationError(&#39;foobar&#39;, {</div>
<div class="line">  cause: new zod.ZodError([</div>
<div class="line">    {</div>
<div class="line">      code: &#39;invalid_string&#39;,</div>
<div class="line">      message: &#39;Invalid email&#39;,</div>
<div class="line">      path: [&#39;email&#39;],</div>
<div class="line">      validation: &#39;email&#39;,</div>
<div class="line">    },</div>
<div class="line">  ]),</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">console.log(error.details); // prints issues from zod error</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md2537"></a>
createMessageBuilder</h2>
<p>Creates zod-validation-error's default <span class="tt">MessageBuilder</span>, which is used to produce user-friendly error messages.</p>
<p>Meant to be passed as an option to fromError, fromZodIssue, fromZodError or toValidationError.</p>
<p>You may read more on the concept of the <span class="tt">MessageBuilder</span> further below.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2538"></a>
Arguments</h3>
<ul>
<li><span class="tt">props</span> - <em>Object</em>; formatting options (optional)<ul>
<li><span class="tt">maxIssuesInMessage</span> - <em>number</em>; max issues to include in user-friendly message (optional, defaults to 99)</li>
<li><span class="tt">issueSeparator</span> - <em>string</em>; used to concatenate issues in user-friendly message (optional, defaults to ";")</li>
<li><span class="tt">unionSeparator</span> - <em>string</em>; used to concatenate union-issues in user-friendly message (optional, defaults to ", or")</li>
<li><span class="tt">prefix</span> - <em>string</em> or <em>null</em>; prefix to use in user-friendly message (optional, defaults to "Validation error"). Pass <span class="tt">null</span> to disable prefix completely.</li>
<li><span class="tt">prefixSeparator</span> - <em>string</em>; used to concatenate prefix with rest of the user-friendly message (optional, defaults to ": "). Not used when <span class="tt">prefix</span> is <span class="tt">null</span>.</li>
<li><span class="tt">includePath</span> - <em>boolean</em>; used to provide control on whether to include the erroneous property name suffix or not (optional, defaults to <span class="tt">true</span>).</li>
</ul>
</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2539"></a>
Example</h3>
<div class="fragment"><div class="line">import { createMessageBuilder } from &#39;zod-validation-error/v3&#39;;</div>
<div class="line"> </div>
<div class="line">const messageBuilder = createMessageBuilder({</div>
<div class="line">  includePath: false,</div>
<div class="line">  maxIssuesInMessage: 3,</div>
<div class="line">});</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md2540"></a>
errorMap</h2>
<p>A custom error map to use with zod's <span class="tt">setErrorMap</span> method and get user-friendly messages automatically.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2541"></a>
Example</h3>
<div class="fragment"><div class="line">import { z as zod } from &#39;zod/v3&#39;;</div>
<div class="line">import { errorMap } from &#39;zod-validation-error/v3&#39;;</div>
<div class="line"> </div>
<div class="line">zod.setErrorMap(errorMap);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md2542"></a>
isValidationError</h2>
<p>A <a href="https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates">type guard</a> utility function, based on <span class="tt">instanceof</span> comparison.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2543"></a>
Arguments</h3>
<ul>
<li><span class="tt">error</span> - error instance (required)</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2544"></a>
Example</h3>
<div class="fragment"><div class="line">import { z as zod } from &#39;zod/v3&#39;;</div>
<div class="line">import { ValidationError, isValidationError } from &#39;zod-validation-error/v3&#39;;</div>
<div class="line"> </div>
<div class="line">const err = new ValidationError(&#39;foobar&#39;);</div>
<div class="line">isValidationError(err); // returns true</div>
<div class="line"> </div>
<div class="line">const invalidErr = new Error(&#39;foobar&#39;);</div>
<div class="line">isValidationError(err); // returns false</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md2545"></a>
isValidationErrorLike</h2>
<p>A <a href="https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates">type guard</a> utility function, based on <em>heuristics</em> comparison.</p>
<p><em>Why do we need heuristics since we can use a simple <span class="tt">instanceof</span> comparison?</em> Because of multi-version inconsistencies. For instance, it's possible that a dependency is using an older <span class="tt">zod-validation-error</span> version internally. In such case, the <span class="tt">instanceof</span> comparison will yield invalid results because module deduplication does not apply at npm/yarn level and the prototype is different.</p>
<p>tl;dr if you are uncertain then it is preferable to use <span class="tt">isValidationErrorLike</span> instead of <span class="tt">isValidationError</span>.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2546"></a>
Arguments</h3>
<ul>
<li><span class="tt">error</span> - error instance (required)</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2547"></a>
Example</h3>
<div class="fragment"><div class="line">import {</div>
<div class="line">  ValidationError,</div>
<div class="line">  isValidationErrorLike,</div>
<div class="line">} from &#39;zod-validation-error/v3&#39;;</div>
<div class="line"> </div>
<div class="line">const err = new ValidationError(&#39;foobar&#39;);</div>
<div class="line">isValidationErrorLike(err); // returns true</div>
<div class="line"> </div>
<div class="line">const invalidErr = new Error(&#39;foobar&#39;);</div>
<div class="line">isValidationErrorLike(err); // returns false</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md2548"></a>
isZodErrorLike</h2>
<p>A <a href="https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates">type guard</a> utility function, based on <em>heuristics</em> comparison.</p>
<p><em>Why do we need heuristics since we can use a simple <span class="tt">instanceof</span> comparison?</em> Because of multi-version inconsistencies. For instance, it's possible that a dependency is using an older <span class="tt">zod</span> version internally. In such case, the <span class="tt">instanceof</span> comparison will yield invalid results because module deduplication does not apply at npm/yarn level and the prototype is different.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2549"></a>
Arguments</h3>
<ul>
<li><span class="tt">error</span> - error instance (required)</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2550"></a>
Example</h3>
<div class="fragment"><div class="line">import { z as zod } from &#39;zod/v3&#39;;</div>
<div class="line">import { ValidationError, isZodErrorLike } from &#39;zod-validation-error/v3&#39;;</div>
<div class="line"> </div>
<div class="line">const zodValidationErr = new ValidationError(&#39;foobar&#39;);</div>
<div class="line">isZodErrorLike(zodValidationErr); // returns false</div>
<div class="line"> </div>
<div class="line">const genericErr = new Error(&#39;foobar&#39;);</div>
<div class="line">isZodErrorLike(genericErr); // returns false</div>
<div class="line"> </div>
<div class="line">const zodErr = new zod.ZodError([</div>
<div class="line">  {</div>
<div class="line">    code: zod.ZodIssueCode.custom,</div>
<div class="line">    path: [],</div>
<div class="line">    message: &#39;foobar&#39;,</div>
<div class="line">    fatal: true,</div>
<div class="line">  },</div>
<div class="line">]);</div>
<div class="line">isZodErrorLike(zodErr); // returns true</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md2551"></a>
fromError</h2>
<p>Converts an error to <span class="tt">ValidationError</span>.</p>
<p><em>What is the difference between <span class="tt">fromError</span> and <span class="tt">fromZodError</span>?</em> The <span class="tt">fromError</span> function is a less strict version of <span class="tt">fromZodError</span>. It can accept an unknown error and attempt to convert it to a <span class="tt">ValidationError</span>.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2552"></a>
Arguments</h3>
<ul>
<li><span class="tt">error</span> - <em>unknown</em>; an error (required)</li>
<li><span class="tt">options</span> - <em>Object</em>; formatting options (optional)<ul>
<li><span class="tt">messageBuilder</span> - <em>MessageBuilder</em>; a function that accepts an array of <span class="tt">zod.ZodIssue</span> objects and returns a user-friendly error message in the form of a <span class="tt">string</span> (optional).</li>
</ul>
</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2553"></a>
Notes</h3>
<p>Alternatively, you may pass the following <span class="tt">options</span> instead of a <span class="tt">messageBuilder</span>.</p>
<ul>
<li><span class="tt">options</span> - <em>Object</em>; formatting options (optional)<ul>
<li><span class="tt">maxIssuesInMessage</span> - <em>number</em>; max issues to include in user-friendly message (optional, defaults to 99)</li>
<li><span class="tt">issueSeparator</span> - <em>string</em>; used to concatenate issues in user-friendly message (optional, defaults to ";")</li>
<li><span class="tt">unionSeparator</span> - <em>string</em>; used to concatenate union-issues in user-friendly message (optional, defaults to ", or")</li>
<li><span class="tt">prefix</span> - <em>string</em> or <em>null</em>; prefix to use in user-friendly message (optional, defaults to "Validation error"). Pass <span class="tt">null</span> to disable prefix completely.</li>
<li><span class="tt">prefixSeparator</span> - <em>string</em>; used to concatenate prefix with rest of the user-friendly message (optional, defaults to ": "). Not used when <span class="tt">prefix</span> is <span class="tt">null</span>.</li>
<li><span class="tt">includePath</span> - <em>boolean</em>; used to provide control on whether to include the erroneous property name suffix or not (optional, defaults to <span class="tt">true</span>).</li>
</ul>
</li>
</ul>
<p>They will be passed as arguments to the createMessageBuilder function. The only reason they exist is to provide backwards-compatibility with older versions of <span class="tt">zod-validation-error</span>. They should however be considered deprecated and may be removed in the future.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md2554"></a>
fromZodIssue</h2>
<p>Converts a single zod issue to <span class="tt">ValidationError</span>.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2555"></a>
Arguments</h3>
<ul>
<li><span class="tt">zodIssue</span> - <em>zod.ZodIssue</em>; a ZodIssue instance (required)</li>
<li><span class="tt">options</span> - <em>Object</em>; formatting options (optional)<ul>
<li><span class="tt">messageBuilder</span> - <em>MessageBuilder</em>; a function that accepts an array of <span class="tt">zod.ZodIssue</span> objects and returns a user-friendly error message in the form of a <span class="tt">string</span> (optional).</li>
</ul>
</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2556"></a>
Notes</h3>
<p>Alternatively, you may pass the following <span class="tt">options</span> instead of a <span class="tt">messageBuilder</span>.</p>
<ul>
<li><span class="tt">options</span> - <em>Object</em>; formatting options (optional)<ul>
<li><span class="tt">issueSeparator</span> - <em>string</em>; used to concatenate issues in user-friendly message (optional, defaults to ";")</li>
<li><span class="tt">unionSeparator</span> - <em>string</em>; used to concatenate union-issues in user-friendly message (optional, defaults to ", or")</li>
<li><span class="tt">prefix</span> - <em>string</em> or <em>null</em>; prefix to use in user-friendly message (optional, defaults to "Validation error"). Pass <span class="tt">null</span> to disable prefix completely.</li>
<li><span class="tt">prefixSeparator</span> - <em>string</em>; used to concatenate prefix with rest of the user-friendly message (optional, defaults to ": "). Not used when <span class="tt">prefix</span> is <span class="tt">null</span>.</li>
<li><span class="tt">includePath</span> - <em>boolean</em>; used to provide control on whether to include the erroneous property name suffix or not (optional, defaults to <span class="tt">true</span>).</li>
</ul>
</li>
</ul>
<p>They will be passed as arguments to the createMessageBuilder function. The only reason they exist is to provide backwards-compatibility with older versions of <span class="tt">zod-validation-error</span>. They should however be considered deprecated and may be removed in the future.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md2557"></a>
fromZodError</h2>
<p>Converts zod error to <span class="tt">ValidationError</span>.</p>
<p><em>Why is the difference between <span class="tt">ZodError</span> and <span class="tt">ZodIssue</span>?</em> A <span class="tt">ZodError</span> is a collection of 1 or more <span class="tt">ZodIssue</span> instances. It's what you get when you call <span class="tt">zodSchema.parse()</span>.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2558"></a>
Arguments</h3>
<ul>
<li><span class="tt">zodError</span> - <em>zod.ZodError</em>; a ZodError instance (required)</li>
<li><span class="tt">options</span> - <em>Object</em>; formatting options (optional)<ul>
<li><span class="tt">messageBuilder</span> - <em>MessageBuilder</em>; a function that accepts an array of <span class="tt">zod.ZodIssue</span> objects and returns a user-friendly error message in the form of a <span class="tt">string</span> (optional).</li>
</ul>
</li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2559"></a>
Notes</h3>
<p>Alternatively, you may pass the following <span class="tt">options</span> instead of a <span class="tt">messageBuilder</span>.</p>
<ul>
<li><span class="tt">options</span> - <em>Object</em>; formatting options (optional)<ul>
<li><span class="tt">maxIssuesInMessage</span> - <em>number</em>; max issues to include in user-friendly message (optional, defaults to 99)</li>
<li><span class="tt">issueSeparator</span> - <em>string</em>; used to concatenate issues in user-friendly message (optional, defaults to ";")</li>
<li><span class="tt">unionSeparator</span> - <em>string</em>; used to concatenate union-issues in user-friendly message (optional, defaults to ", or")</li>
<li><span class="tt">prefix</span> - <em>string</em> or <em>null</em>; prefix to use in user-friendly message (optional, defaults to "Validation error"). Pass <span class="tt">null</span> to disable prefix completely.</li>
<li><span class="tt">prefixSeparator</span> - <em>string</em>; used to concatenate prefix with rest of the user-friendly message (optional, defaults to ": "). Not used when <span class="tt">prefix</span> is <span class="tt">null</span>.</li>
<li><span class="tt">includePath</span> - <em>boolean</em>; used to provide control on whether to include the erroneous property name suffix or not (optional, defaults to <span class="tt">true</span>).</li>
</ul>
</li>
</ul>
<p>They will be passed as arguments to the createMessageBuilder function. The only reason they exist is to provide backwards-compatibility with older versions of <span class="tt">zod-validation-error</span>. They should however be considered deprecated and may be removed in the future.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md2560"></a>
toValidationError</h2>
<p>A curried version of <span class="tt">fromZodError</span> meant to be used for FP (Functional Programming). Note it first takes the options object if needed and returns a function that converts the <span class="tt">zodError</span> to a <span class="tt">ValidationError</span> object</p>
<div class="fragment"><div class="line">toValidationError(options) =&gt; (zodError) =&gt; ValidationError</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md2561"></a>
Example using fp-ts</h3>
<div class="fragment"><div class="line">import * as Either from &#39;fp-ts/Either&#39;;</div>
<div class="line">import { z as zod } from &#39;zod/v3&#39;;</div>
<div class="line">import { toValidationError, ValidationError } from &#39;zod-validation-error/v3&#39;;</div>
<div class="line"> </div>
<div class="line">// create zod schema</div>
<div class="line">const zodSchema = zod</div>
<div class="line">  .object({</div>
<div class="line">    id: zod.number().int().positive(),</div>
<div class="line">    email: zod.string().email(),</div>
<div class="line">  })</div>
<div class="line">  .brand&lt;&#39;User&#39;&gt;();</div>
<div class="line"> </div>
<div class="line">export type User = zod.infer&lt;typeof zodSchema&gt;;</div>
<div class="line"> </div>
<div class="line">export function parse(</div>
<div class="line">  value: zod.input&lt;typeof zodSchema&gt;</div>
<div class="line">): Either.Either&lt;ValidationError, User&gt; {</div>
<div class="line">  return Either.tryCatch(() =&gt; schema.parse(value), toValidationError());</div>
<div class="line">}</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md2562"></a>
MessageBuilder</h1>
<p><span class="tt">zod-validation-error</span> can be configured with a custom <span class="tt">MessageBuilder</span> function in order to produce case-specific error messages.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2563"></a>
Example</h3>
<p>For instance, one may want to print <span class="tt">invalid_string</span> errors to the console in red color.</p>
<div class="fragment"><div class="line">import { z as zod } from &#39;zod/v3&#39;;</div>
<div class="line">import { type MessageBuilder, fromError } from &#39;zod-validation-error/v3&#39;;</div>
<div class="line">import chalk from &#39;chalk&#39;;</div>
<div class="line"> </div>
<div class="line">// create custom MessageBuilder</div>
<div class="line">const myMessageBuilder: MessageBuilder = (issues) =&gt; {</div>
<div class="line">  return (</div>
<div class="line">    issues</div>
<div class="line">      // format error message</div>
<div class="line">      .map((issue) =&gt; {</div>
<div class="line">        if (issue.code === zod.ZodIssueCode.invalid_string) {</div>
<div class="line">          return chalk.red(issue.message);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        return issue.message;</div>
<div class="line">      })</div>
<div class="line">      // join as string with new-line character</div>
<div class="line">      .join(&#39;\n&#39;)</div>
<div class="line">  );</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">// create zod schema</div>
<div class="line">const zodSchema = zod.object({</div>
<div class="line">  id: zod.number().int().positive(),</div>
<div class="line">  email: zod.string().email(),</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// parse some invalid value</div>
<div class="line">try {</div>
<div class="line">  zodSchema.parse({</div>
<div class="line">    id: 1,</div>
<div class="line">    email: &#39;foobar&#39;, // note: invalid email value</div>
<div class="line">  });</div>
<div class="line">} catch (err) {</div>
<div class="line">  const validationError = fromError(err, {</div>
<div class="line">    messageBuilder: myMessageBuilder,</div>
<div class="line">  });</div>
<div class="line">  // the error is now displayed with red letters</div>
<div class="line">  console.log(validationError.toString());</div>
<div class="line">}</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md2564"></a>
FAQ</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md2565"></a>
How to distinguish between errors</h2>
<p>Use the <span class="tt">isValidationErrorLike</span> type guard.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2566"></a>
Example</h3>
<p>Scenario: Distinguish between <span class="tt">ValidationError</span> VS generic <span class="tt">Error</span> in order to respond with 400 VS 500 HTTP status code respectively.</p>
<div class="fragment"><div class="line">import * as Either from &#39;fp-ts/Either&#39;;</div>
<div class="line">import { z as zod } from &#39;zod/v3&#39;;</div>
<div class="line">import { isValidationErrorLike } from &#39;zod-validation-error/v3&#39;;</div>
<div class="line"> </div>
<div class="line">try {</div>
<div class="line">  func(); // throws Error - or - ValidationError</div>
<div class="line">} catch (err) {</div>
<div class="line">  if (isValidationErrorLike(err)) {</div>
<div class="line">    return 400; // Bad Data (this is a client error)</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  return 500; // Server Error</div>
<div class="line">}</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md2567"></a>
How to use <span class="tt">ValidationError</span> outside <span class="tt">zod</span></h2>
<p>It's possible to implement custom validation logic outside <span class="tt">zod</span> and throw a <span class="tt">ValidationError</span>.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2568"></a>
Example 1: passing custom message</h3>
<div class="fragment"><div class="line">import { ValidationError } from &#39;zod-validation-error/v3&#39;;</div>
<div class="line">import { Buffer } from &#39;node:buffer&#39;;</div>
<div class="line"> </div>
<div class="line">function parseBuffer(buf: unknown): Buffer {</div>
<div class="line">  if (!Buffer.isBuffer(buf)) {</div>
<div class="line">    throw new ValidationError(&#39;Invalid argument; expected buffer&#39;);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  return buf;</div>
<div class="line">}</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md2569"></a>
Example 2: passing custom message and original error as cause</h3>
<div class="fragment"><div class="line">import { ValidationError } from &#39;zod-validation-error/v3&#39;;</div>
<div class="line"> </div>
<div class="line">try {</div>
<div class="line">  // do something that throws an error</div>
<div class="line">} catch (err) {</div>
<div class="line">  throw new ValidationError(&#39;Something went deeply wrong&#39;, { cause: err });</div>
<div class="line">}</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md2570"></a>
How to use <span class="tt">ValidationError</span> with custom "error map"</h2>
<p>Zod supports customizing error messages by providing a custom "error map". You may combine this with <span class="tt">zod-validation-error</span> to produce user-friendly messages.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2571"></a>
Example 1: produce user-friendly error messages using the <span class="tt">errorMap</span> property</h3>
<p>If all you need is to produce user-friendly error messages you may use the <span class="tt">errorMap</span> property.</p>
<div class="fragment"><div class="line">import { z as zod } from &#39;zod/v3&#39;;</div>
<div class="line">import { errorMap } from &#39;zod-validation-error/v3&#39;;</div>
<div class="line"> </div>
<div class="line">zod.setErrorMap(errorMap);</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md2572"></a>
Example 2: extra customization using <span class="tt">fromZodIssue</span></h3>
<p>If you need to customize some error code, you may use the <span class="tt">fromZodIssue</span> function.</p>
<div class="fragment"><div class="line">import { z as zod } from &#39;zod/v3&#39;;</div>
<div class="line">import { fromZodIssue } from &#39;zod-validation-error/v3&#39;;</div>
<div class="line"> </div>
<div class="line">const customErrorMap: zod.ZodErrorMap = (issue, ctx) =&gt; {</div>
<div class="line">  switch (issue.code) {</div>
<div class="line">    case ZodIssueCode.invalid_type: {</div>
<div class="line">      return {</div>
<div class="line">        message:</div>
<div class="line">          &#39;Custom error message of your preference for invalid_type errors&#39;,</div>
<div class="line">      };</div>
<div class="line">    }</div>
<div class="line">    default: {</div>
<div class="line">      const validationError = fromZodIssue({</div>
<div class="line">        ...issue,</div>
<div class="line">        // fallback to the default error message</div>
<div class="line">        // when issue does not have a message</div>
<div class="line">        message: issue.message ?? ctx.defaultError,</div>
<div class="line">      });</div>
<div class="line"> </div>
<div class="line">      return {</div>
<div class="line">        message: validationError.message,</div>
<div class="line">      };</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">zod.setErrorMap(customErrorMap);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md2573"></a>
How to use <span class="tt">zod-validation-error</span> with <span class="tt">react-hook-form</span>?</h2>
<div class="fragment"><div class="line">import { useForm } from &#39;react-hook-form&#39;;</div>
<div class="line">import { zodResolver } from &#39;@hookform/resolvers/zod&#39;;</div>
<div class="line">import { errorMap } from &#39;zod-validation-error/v3&#39;;</div>
<div class="line"> </div>
<div class="line">useForm({</div>
<div class="line">  resolver: zodResolver(schema, { errorMap }),</div>
<div class="line">});</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md2574"></a>
Does <span class="tt">zod-validation-error</span> support CommonJS</h2>
<p>Yes, <span class="tt">zod-validation-error</span> supports CommonJS out-of-the-box. All you need to do is import it using <span class="tt">require</span>.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2575"></a>
Example</h3>
<div class="fragment"><div class="line">const { ValidationError } = require(&#39;zod-validation-error&#39;);</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md2576"></a>
Contribute</h1>
<p>Source code contributions are most welcome. Please open a PR, ensure the linter is satisfied and all tests pass.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2577"></a>
We are hiring</h3>
<p>Causaly is building the world's largest biomedical knowledge platform, using technologies such as TypeScript, React and Node.js. Find out more about our openings at <a href="https://jobs.ashbyhq.com/causaly">https://jobs.ashbyhq.com/causaly</a>.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md2578"></a>
License</h1>
<p>MIT </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
</body>
</html>
